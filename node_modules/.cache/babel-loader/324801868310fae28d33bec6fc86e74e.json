{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/PickAxe-website/src/views/modal/CreditCardForm.js\";\nimport React from 'react';\nimport PropTypes from \"prop-types\";\nimport { Button, message, Result } from 'antd';\nimport styles from '../../styles/modal/credit-card-modal.module.scss';\nimport { CardElement, injectStripe } from 'react-stripe-elements';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nconst style = {\n  base: {\n    iconColor: '#c4f0ff',\n    color: '#fff',\n    fontWeight: 500,\n    fontFamily: 'Roboto, Open Sans, Segoe UI, sans-serif',\n    fontSize: '14px',\n    fontSmoothing: 'antialiased',\n    ':-webkit-autofill': {\n      color: '#fce883'\n    },\n    '::placeholder': {\n      color: '#87BBFD'\n    }\n  },\n  invalid: {\n    iconColor: '#FFC7EE',\n    color: '#FFC7EE'\n  }\n}; // You can customize your Elements to give it the look and feel of your site.\n\nconst createOptions = () => {\n  return {\n    style: {\n      base: {\n        fontSize: '16px',\n        color: '#424770',\n        fontFamily: 'Open Sans, sans-serif',\n        letterSpacing: '0.025em',\n        '::placeholder': {\n          color: '#aab7c4'\n        }\n      },\n      invalid: {\n        color: '#c23d4b'\n      }\n    }\n  };\n};\n\nclass _CardForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      errorMessage: '',\n      paymentStatus: 'init'\n    };\n\n    this.handleChange = ({\n      error\n    }) => {\n      if (error) {\n        this.setState({\n          errorMessage: error.message\n        });\n      }\n    };\n\n    this.handleSubmit = evt => {\n      let thisPage = this;\n      this.setState({\n        processing: true\n      });\n      evt.preventDefault();\n\n      if (this.props.stripe) {\n        this.props.stripe.createToken().then(function (result) {\n          if (result.token) {\n            // alert(JSON.stringify(result));\n            thisPage.creditCardPayment(result.token.id);\n          } else {\n            // alert(JSON.stringify(result.error));\n            thisPage.setState({\n              processing: false\n            });\n          }\n        });\n      } else {\n        console.log(\"Stripe.js hasn't loaded yet.\");\n        thisPage.setState({\n          processing: false\n        });\n      }\n    };\n  }\n\n  creditCardPayment(token) {\n    let thisPage = this;\n    new WebServerRestClient().POST('/user/payment/create-credit-order', {\n      purchasePlanId: this.props.productDetail.id,\n      paymentWay: 5,\n      userId: StorageUtils.getUserId(),\n      sourceId: token\n    }).then(response => {\n      if (response.code == 200) {\n        thisPage.setState({\n          paymentStatus: 'success'\n        });\n      } else if (response.code == 401 || response.code == 403) {\n        message.warn(\"请登录！\");\n      } else {\n        message.warn(response['msg']);\n        thisPage.setState({\n          paymentStatus: 'error'\n        });\n      }\n    }).catch(err => {\n      message.error(err.message);\n    });\n  }\n\n  render() {\n    if (this.state.paymentStatus === 'init') {\n      return /*#__PURE__*/React.createElement(\"form\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(CardElement, Object.assign({\n        className: styles.MyCardElement,\n        style: style,\n        onChange: this.handleChange.bind(this)\n      }, createOptions(), {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.err_message,\n        role: \"alert\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 21\n        }\n      }, this.state.errorMessage), /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleSubmit.bind(this),\n        loading: this.state.processing,\n        className: styles.payment_button,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }\n      }, \"Pay $\", this.props.productDetail.amount));\n    } else if (this.state.paymentStatus === 'success') {\n      return /*#__PURE__*/React.createElement(Result, {\n        status: \"success\",\n        title: window.language.payment_results.success,\n        subTitle: window.language.payment_results.success_details,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 17\n        }\n      });\n    } else if (this.state.paymentStatus === 'error') {\n      return /*#__PURE__*/React.createElement(Result, {\n        status: \"error\",\n        title: window.language.payment_results.error,\n        subTitle: window.language.payment_results.error_details,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 17\n        }\n      });\n    }\n  }\n\n}\n\n_CardForm.propTypes = {\n  productDetail: PropTypes.object\n};\nexport default injectStripe(_CardForm);","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/PickAxe-website/src/views/modal/CreditCardForm.js"],"names":["React","PropTypes","Button","message","Result","styles","CardElement","injectStripe","WebServerRestClient","StorageUtils","style","base","iconColor","color","fontWeight","fontFamily","fontSize","fontSmoothing","invalid","createOptions","letterSpacing","_CardForm","Component","state","errorMessage","paymentStatus","handleChange","error","setState","handleSubmit","evt","thisPage","processing","preventDefault","props","stripe","createToken","then","result","token","creditCardPayment","id","console","log","POST","purchasePlanId","productDetail","paymentWay","userId","getUserId","sourceId","response","code","warn","catch","err","render","MyCardElement","bind","err_message","payment_button","amount","window","language","payment_results","success","success_details","error_details","propTypes","object"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from \"prop-types\";\nimport {Button, message, Result} from 'antd';\nimport styles from '../../styles/modal/credit-card-modal.module.scss';\nimport {CardElement, injectStripe} from 'react-stripe-elements';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\n\nconst style = {\n    base: {\n        iconColor: '#c4f0ff',\n        color: '#fff',\n        fontWeight: 500,\n        fontFamily: 'Roboto, Open Sans, Segoe UI, sans-serif',\n        fontSize: '14px',\n        fontSmoothing: 'antialiased',\n\n        ':-webkit-autofill': {\n            color: '#fce883',\n        },\n        '::placeholder': {\n            color: '#87BBFD',\n        },\n    },\n    invalid: {\n        iconColor: '#FFC7EE',\n        color: '#FFC7EE',\n    },\n};\n\n// You can customize your Elements to give it the look and feel of your site.\nconst createOptions = () => {\n    return {\n        style: {\n            base: {\n                fontSize: '16px',\n                color: '#424770',\n                fontFamily: 'Open Sans, sans-serif',\n                letterSpacing: '0.025em',\n                '::placeholder': {\n                    color: '#aab7c4',\n                },\n            },\n            invalid: {\n                color: '#c23d4b',\n            },\n        }\n    }\n};\n\n\nclass _CardForm extends React.Component {\n\n    static propTypes = {\n        productDetail: PropTypes.object\n    };\n\n    state = {\n        errorMessage: '',\n        paymentStatus: 'init'\n    };\n\n    handleChange = ({error}) => {\n        if (error) {\n            this.setState({errorMessage: error.message});\n        }\n    };\n\n    handleSubmit = (evt) => {\n        let thisPage = this;\n        this.setState({processing: true});\n        evt.preventDefault();\n        if (this.props.stripe) {\n            this.props.stripe.createToken().then(function (result) {\n                if (result.token) {\n                    // alert(JSON.stringify(result));\n                    thisPage.creditCardPayment(result.token.id);\n                } else {\n                    // alert(JSON.stringify(result.error));\n                    thisPage.setState({processing: false});\n                }\n            });\n        } else {\n            console.log(\"Stripe.js hasn't loaded yet.\");\n            thisPage.setState({processing: false});\n        }\n    };\n\n    creditCardPayment(token) {\n        let thisPage = this;\n        new WebServerRestClient().POST('/user/payment/create-credit-order',{\n            purchasePlanId: this.props.productDetail.id,\n            paymentWay: 5,\n            userId: StorageUtils.getUserId(),\n            sourceId: token\n        }).then(response => {\n            if (response.code == 200) {\n                thisPage.setState({paymentStatus: 'success'});\n            } else if (response.code == 401 || response.code == 403) {\n                message.warn(\"请登录！\")\n            } else {\n                message.warn(response['msg']);\n                thisPage.setState({paymentStatus: 'error'});\n            }\n        }).catch(err => {\n            message.error(err.message);\n        });\n    }\n\n    render() {\n        if (this.state.paymentStatus === 'init') {\n            return (\n                <form>\n                    <CardElement className={styles.MyCardElement} style={style}\n                                 onChange={this.handleChange.bind(this)}\n                                 {...createOptions()}\n                    />\n                    <div className={styles.err_message} role=\"alert\">\n                        {this.state.errorMessage}\n                    </div>\n                    <Button onClick={this.handleSubmit.bind(this)} loading={this.state.processing}\n                            className={styles.payment_button}>Pay ${this.props.productDetail.amount}</Button>\n                </form>\n            );\n        } else if (this.state.paymentStatus === 'success') {\n            return (\n                <Result\n                    status=\"success\"\n                    title= {window.language.payment_results.success}\n                    subTitle= {window.language.payment_results.success_details}\n                />\n            );\n        } else if (this.state.paymentStatus === 'error') {\n            return (\n                <Result\n                    status=\"error\"\n                    title= {window.language.payment_results.error}\n                    subTitle= {window.language.payment_results.error_details}\n                />\n            );\n        }\n    }\n}\n\nexport default injectStripe(_CardForm);\n"]},"metadata":{},"sourceType":"module"}