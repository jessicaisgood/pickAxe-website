{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/website/src/views/Payment.js\";\nimport React from 'react';\nimport styles from '../styles/payment.module.scss';\nimport 'antd/dist/antd.css';\nimport { Icon, message, Spin, notification } from 'antd';\nimport WebServerRestClient from \"../tools/WebServerRestClient\";\nimport copy from 'copy-to-clipboard';\nimport UserComponent from \"../components/UserComponent\";\n\nconst QRCode = require('qrcode.react');\n\nexport default class Payment extends UserComponent {\n  constructor(props) {\n    super(props);\n\n    this.openNotificationWithIcon = (type, description, callback) => {\n      notification[type]({\n        placement: 'bottomRight',\n        message: '交易结果',\n        description: description,\n        onClose: callback\n      });\n    };\n\n    this.state = {\n      orderId: '',\n      qrcodeUrl: ''\n    };\n  }\n\n  componentDidMount() {\n    this.createOrder();\n  }\n\n  createOrder() {\n    new WebServerRestClient().POST('/user/create-eth-order', {\n      userId: window.CurrentUser.userId,\n      purchasePlanId: 20003\n    }).then(response => {\n      console.log(\"create-eth-order response -> \" + JSON.stringify(response));\n      this.setState({\n        loading: false\n      });\n\n      if (response.code == 200) {\n        let qrcodeUrl = 'ethereum:' + response.data.receiptAddress + '?decimal=18&value=' + response.data.weiAmount;\n        this.setState({\n          orderId: response.data.orderId,\n          receiptAddress: response.data.receiptAddress,\n          currency: response.data.currency,\n          amount: response.data.amount,\n          weiAmount: response.data.weiAmount,\n          usdPrice: response.data.usdPrice,\n          usdAmount: response.data.usdAmount,\n          qrcodeUrl: qrcodeUrl\n        });\n      } else if (response.code == 401 || response.code == 403) {\n        message.warn(\"未登录！\");\n        this.props.history.push('/login');\n      } else {\n        message.warn(response['msg']);\n      }\n    }).catch(err => {\n      this.setState({\n        loading: false\n      });\n      message.error(\"Error: \" + err.message);\n    });\n  }\n\n  copyWalletAddress() {\n    copy(this.state.receiptAddress);\n    message.success('复制成功！');\n  }\n\n  confirmPayment() {\n    this.setState({\n      doing: true\n    }); // check payment status\n\n    new WebServerRestClient().POST('/user/check-user-params', {\n      userId: window.CurrentUser.userId\n    }).then(response => {\n      console.log(\"check-user-params response -> \" + JSON.stringify(response));\n      this.setState({\n        doing: false\n      });\n\n      if (response.code == 200) {\n        this.openNotificationWithIcon(\"success\", '订单已完成，请在APP中查看服务到期时间.', () => {\n          this.props.history.push('/user-center');\n        });\n      } else if (response.code === 101) {\n        this.props.history.push('/binding-wallet');\n      } else if (response.code === 102) {\n        this.props.history.push('/binding-code');\n      } else if (response.code === 103) {\n        this.openNotificationWithIcon(\"warning\", '交易未完成，请稍后...');\n      } else if (response.code === 401 || response.code === 403) {\n        message.warn(\"未登录！\");\n        this.props.history.push('/login');\n      } else {\n        message.warn(response['msg']);\n      }\n    }).catch(err => {\n      this.setState({\n        doing: false\n      });\n      message.error(\"Error: \" + err.message);\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, React.createElement(Spin, {\n      tip: \"\\u52A0\\u8F7D\\u4E2D\",\n      spinning: this.state.loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.form_center,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: styles.step_image,\n      src: require('../images/step-payment.png'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.step_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, \"\\u8BF7\\u5C06ETH\\u652F\\u4ED8\\u81F3\\u5982\\u4E0B\\u5730\\u5740\\uFF1A\"), React.createElement(\"div\", {\n      className: styles.step_desc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"\\u4EE3\\u5E01\\u7C7B\\u578B\\uFF1A \", this.state.currency, \" \\uFF08\\u4E0D\\u8981\\u652F\\u4ED8\\u5176\\u4ED6\\u4EE3\\u5E01\\uFF09\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), \"\\u652F\\u4ED8\\u91D1\\u989D\\uFF1A \", this.state.amount, \"\\uFF08\\u4ED8\\u6B3E\\u91D1\\u989D\\u5FC5\\u987B\\u4E00\\u81F4\\uFF09\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      style: {\n        color: '#c758d6'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"\\u8BF7\\u4F7F\\u7528\\u7B2C\\u4E00\\u6B65\\u4E2D\\u7ED1\\u5B9A\\u7684ETH\\u94B1\\u5305\\u4ED8\\u6B3E\")), React.createElement(\"div\", {\n      className: styles.account_center,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(QRCode, {\n      value: this.state.qrcodeUrl,\n      size: 140,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.wallet_address,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, this.state.receiptAddress), React.createElement(\"img\", {\n      className: styles.btn_copy,\n      onClick: this.copyWalletAddress.bind(this),\n      src: require('../images/btn-copy-address.png'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.payment_tip,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"\\u4ED8\\u6B3E\\u5B8C\\u6210\\u540E\\uFF0C\\u8BF7\\u8010\\u5FC3\\u7B49\\u5F853~5\\u5206\\u949F\\u3002\\u7136\\u540E\\u70B9\\u51FB\\u6309\\u94AE\\u67E5\\u8BE2\\u4EA4\\u6613\\u7ED3\\u679C\\uFF0C\\u4EA4\\u6613\\u6210\\u529F\\u4E4B\\u540E\\u8FDB\\u5165\\u4E2A\\u4EBA\\u4E3B\\u9875\\u3002\"), React.createElement(\"div\", {\n      className: styles.form_button_row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: styles.form_button,\n      onClick: this.confirmPayment.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, this.state.doing ? React.createElement(Spin, {\n      indicator: React.createElement(Icon, {\n        type: \"loading\",\n        className: \"icon_loading\",\n        spin: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }) : '确认支付完成')), React.createElement(\"div\", {\n      className: styles.link_back_div,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      className: styles.link_back,\n      onClick: () => this.props.history.push('/binding-code'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, \"\\u8FD4\\u56DE\\u4E0A\\u4E00\\u6B65\")))));\n  }\n\n}","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/website/src/views/Payment.js"],"names":["React","styles","Icon","message","Spin","notification","WebServerRestClient","copy","UserComponent","QRCode","require","Payment","constructor","props","openNotificationWithIcon","type","description","callback","placement","onClose","state","orderId","qrcodeUrl","componentDidMount","createOrder","POST","userId","window","CurrentUser","purchasePlanId","then","response","console","log","JSON","stringify","setState","loading","code","data","receiptAddress","weiAmount","currency","amount","usdPrice","usdAmount","warn","history","push","catch","err","error","copyWalletAddress","success","confirmPayment","doing","render","container","form_center","step_image","step_title","step_desc","color","account_center","wallet_address","btn_copy","bind","payment_tip","form_button_row","form_button","link_back_div","link_back"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styles from '../styles/payment.module.scss';\nimport 'antd/dist/antd.css';\nimport {Icon, message, Spin,notification} from 'antd';\nimport WebServerRestClient from \"../tools/WebServerRestClient\";\nimport copy from 'copy-to-clipboard';\nimport UserComponent from \"../components/UserComponent\";\nconst QRCode = require('qrcode.react');\n\nexport default class Payment extends UserComponent {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            orderId: '',\n            qrcodeUrl: '',\n        }\n    }\n\n    componentDidMount() {\n        this.createOrder();\n    }\n\n    createOrder(){\n        new WebServerRestClient().POST('/user/create-eth-order', {\n            userId: window.CurrentUser.userId,\n            purchasePlanId: 20003\n        }).then(response => {\n            console.log(\"create-eth-order response -> \" + JSON.stringify(response));\n            this.setState({loading: false});\n            if (response.code == 200) {\n                let qrcodeUrl = 'ethereum:'\n                    + response.data.receiptAddress\n                    + '?decimal=18&value='\n                    + response.data.weiAmount;\n                this.setState({\n                    orderId: response.data.orderId,\n                    receiptAddress: response.data.receiptAddress,\n                    currency: response.data.currency,\n                    amount: response.data.amount,\n                    weiAmount: response.data.weiAmount,\n                    usdPrice: response.data.usdPrice,\n                    usdAmount: response.data.usdAmount,\n                    qrcodeUrl: qrcodeUrl\n                })\n            } else if (response.code == 401 || response.code == 403) {\n                message.warn(\"未登录！\");\n                this.props.history.push('/login');\n            } else {\n                message.warn(response['msg'])\n            }\n        }).catch(err => {\n            this.setState({loading: false});\n            message.error(\"Error: \" + err.message);\n        });\n    }\n\n    copyWalletAddress(){\n        copy(this.state.receiptAddress);\n        message.success('复制成功！');\n    }\n\n    confirmPayment(){\n        this.setState({doing: true});\n        // check payment status\n        new WebServerRestClient().POST('/user/check-user-params', {\n            userId: window.CurrentUser.userId\n        }).then(response => {\n            console.log(\"check-user-params response -> \" + JSON.stringify(response));\n            this.setState({doing: false});\n            if (response.code == 200) {\n                this.openNotificationWithIcon(\n                    \"success\",\n                    '订单已完成，请在APP中查看服务到期时间.',\n                    () => {\n                        this.props.history.push('/user-center');\n                    });\n            } else if (response.code === 101) {\n                this.props.history.push('/binding-wallet');\n            } else if (response.code === 102) {\n                this.props.history.push('/binding-code');\n            } else if (response.code === 103) {\n                this.openNotificationWithIcon(\"warning\",'交易未完成，请稍后...');\n            } else if (response.code === 401 || response.code === 403) {\n                message.warn(\"未登录！\");\n                this.props.history.push('/login');\n            } else {\n                message.warn(response['msg'])\n            }\n        }).catch(err => {\n            this.setState({doing: false});\n            message.error(\"Error: \" + err.message);\n        });\n    }\n\n    openNotificationWithIcon = (type, description, callback) => {\n        notification[type]({\n            placement: 'bottomRight',\n            message: '交易结果',\n            description: description,\n            onClose: callback\n        });\n    };\n\n    render() {\n        return (\n            <div className={styles.container}>\n                <Spin tip=\"加载中\" spinning={this.state.loading}>\n                <div className={styles.form_center}>\n                    <img className={styles.step_image} src={require('../images/step-payment.png')}/>\n                    <div className={styles.step_title}>请将ETH支付至如下地址：</div>\n                    <div className={styles.step_desc}>\n                        代币类型： {this.state.currency} （不要支付其他代币）<br/>\n                        支付金额： {this.state.amount}（付款金额必须一致）<br/>\n                        <span style={{color: '#c758d6'}}>请使用第一步中绑定的ETH钱包付款</span>\n                    </div>\n                    <div className={styles.account_center}>\n                        <QRCode value={this.state.qrcodeUrl} size={140}/>\n                        <div className={styles.wallet_address}>{this.state.receiptAddress}</div>\n                        <img className={styles.btn_copy}\n                             onClick={this.copyWalletAddress.bind(this)}\n                             src={require('../images/btn-copy-address.png')}/>\n                    </div>\n                    <div className={styles.payment_tip}>\n                        付款完成后，请耐心等待3~5分钟。然后点击按钮查询交易结果，交易成功之后进入个人主页。\n                    </div>\n                    <div className={styles.form_button_row}>\n                        <button className={styles.form_button} onClick={this.confirmPayment.bind(this)}>\n                            {this.state.doing ?\n                                <Spin indicator={<Icon type=\"loading\" className='icon_loading' spin/>}/>\n                                :\n                                '确认支付完成'\n                            }\n                        </button>\n                    </div>\n                    <div className={styles.link_back_div}>\n                        <a className={styles.link_back} onClick={()=>this.props.history.push('/binding-code')}>返回上一步</a>\n                    </div>\n                </div>\n                </Spin>\n            </div>\n        );\n    }\n\n}"]},"metadata":{},"sourceType":"module"}