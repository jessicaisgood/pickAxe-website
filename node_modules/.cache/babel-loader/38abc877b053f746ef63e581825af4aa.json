{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js\";\nimport React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport { Button, message, Modal, Icon } from 'antd';\nimport UserComponent from \"../../components/UserComponent\";\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\nexport default class PaymentModal extends UserComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      processing: false\n    };\n  }\n\n  selectPaymentMethod(method) {\n    if (!StorageUtils.hasToken()) {\n      // need to login\n      this.props.loginCallback();\n      return;\n    }\n\n    if (method == 'credit') {\n      this.setState({\n        processing_credit: true\n      });\n      new WebServerRestClient().GET('/user/token-validation').then(response => {\n        this.setState({\n          processing_credit: false\n        });\n\n        if (response.code == 200) {\n          this.props.selectionCallback(method);\n        } else if (response.code == 401 || response.code == 403) {\n          this.props.loginCallback();\n          message.warn(\"请登录！\");\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        message.error(err.message);\n        this.setState({\n          processing_credit: false\n        });\n      });\n    } else if (method == 'alipay') {\n      this.setState({\n        processing_alipay: true\n      });\n      new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n        purchasePlanId: this.props.productDetail.id,\n        paymentWay: 6,\n        userId: window.CurrentUser.userId\n      }).then(response => {\n        CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n        this.setState({\n          processing_alipay: false\n        });\n\n        if (response.code == 200) {\n          // go to Alipay page\n          let a = document.createElement('a');\n          a.target = '_blank';\n          a.href = response.data;\n          a.click();\n        } else if (response.code == 401 || response.code == 403) {\n          // need to login\n          this.props.loginCallback();\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        this.setState({\n          processing_alipay: false\n        });\n        message.error(err.message);\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(Modal, {\n      closable: false,\n      keyboard: true,\n      maskClosable: true,\n      destroyOnClose: true,\n      footer: null,\n      visible: this.props.visible,\n      onCancel: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal_close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"close-circle\",\n      onClick: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.product_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"SquirrelVPN \", this.props.productDetail.days, \" Days\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_details,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Unlimited data & support 3 devices\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"$\", this.props.productDetail.price, \" x \", this.props.productDetail.month, React.createElement(\"span\", {\n      style: {\n        marginLeft: 20\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"Total: $\", this.props.productDetail.amount)), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_details,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Select Payment:\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      icon: \"alipay\",\n      className: styles.payment_method_item,\n      loading: this.state.processing_alipay,\n      onClick: () => this.selectPaymentMethod('alipay'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"Alipay\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      icon: \"credit-card\",\n      className: styles.payment_method_item,\n      loading: this.state.processing_credit,\n      onClick: () => this.selectPaymentMethod('credit'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"Credit Card\"))));\n  }\n\n}\nPaymentModal.propTypes = {\n  visible: PropTypes.bool,\n  productDetail: PropTypes.object,\n  loginCallback: PropTypes.func,\n  selectionCallback: PropTypes.func,\n  onRequestClose: PropTypes.func\n};","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js"],"names":["React","PropTypes","styles","Button","message","Modal","Icon","UserComponent","WebServerRestClient","StorageUtils","CommonUtils","PaymentModal","constructor","props","state","processing","selectPaymentMethod","method","hasToken","loginCallback","setState","processing_credit","GET","then","response","code","selectionCallback","warn","catch","err","error","processing_alipay","POST","purchasePlanId","productDetail","id","paymentWay","userId","window","CurrentUser","log","JSON","stringify","a","document","createElement","target","href","data","click","render","visible","onRequestClose","container","product_title","days","product_details","product_price","price","month","marginLeft","amount","payment_method_item","propTypes","bool","object","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport {Button, message, Modal, Icon} from 'antd';\nimport UserComponent from \"../../components/UserComponent\";\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\n\nexport default class PaymentModal extends UserComponent {\n\n    static propTypes = {\n        visible: PropTypes.bool,\n        productDetail: PropTypes.object,\n        loginCallback: PropTypes.func,\n        selectionCallback: PropTypes.func,\n        onRequestClose: PropTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            processing: false\n        }\n    }\n\n    selectPaymentMethod(method) {\n        if (!StorageUtils.hasToken()) {\n            // need to login\n            this.props.loginCallback();\n            return;\n        }\n\n        if (method == 'credit'){\n            this.setState({processing_credit: true});\n            new WebServerRestClient().GET('/user/token-validation')\n                .then(response => {\n                    this.setState({processing_credit: false});\n                    if (response.code == 200) {\n                        this.props.selectionCallback(method);\n                    } else if (response.code == 401 || response.code == 403) {\n                        this.props.loginCallback();\n                        message.warn(\"请登录！\")\n                    } else {\n                        message.warn(response['msg']);\n                    }\n                }).catch(err => {\n                message.error(err.message);\n                this.setState({processing_credit: false});\n            });\n        } else if (method == 'alipay') {\n            this.setState({processing_alipay: true});\n            new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n                purchasePlanId: this.props.productDetail.id,\n                paymentWay: 6,\n                userId: window.CurrentUser.userId\n            }).then(response => {\n                CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n                this.setState({processing_alipay: false});\n                if (response.code == 200) {\n                    // go to Alipay page\n                    let a = document.createElement('a');\n                    a.target = '_blank';\n                    a.href = response.data;\n                    a.click();\n                } else if (response.code == 401 || response.code == 403) {\n                    // need to login\n                    this.props.loginCallback();\n                } else {\n                    message.warn(response['msg']);\n                }\n            }).catch(err => {\n                this.setState({processing_alipay: false});\n                message.error(err.message);\n            });\n        }\n    }\n\n\n    render() {\n        return (\n            <Modal\n                closable={false}\n                keyboard={true}\n                maskClosable={true}\n                destroyOnClose={true}\n                footer={null}\n                visible={this.props.visible }\n                onCancel={() => this.props.onRequestClose()}>\n                <div className=\"modal_close\">\n                    <Icon type=\"close-circle\" onClick={() => this.props.onRequestClose()}/>\n                </div>\n                <div className={styles.container}>\n                    <div  className={styles.product_title}\n                      >SquirrelVPN {this.props.productDetail.days} Days</div>\n                    <br/>\n                    <div  className={styles.product_details}\n                      >Unlimited data & support 3 devices</div>\n                    <br/>\n                    <div  className={styles.product_price}>\n                        ${this.props.productDetail.price} x {this.props.productDetail.month}\n                        <span style={{marginLeft: 20}}>Total: ${this.props.productDetail.amount}</span>\n                    </div>\n                    <div>\n                        <br/>\n                        <div className={styles.product_details}>Select Payment:</div>\n                        <br/>\n                        <Button type=\"primary\" icon=\"alipay\" className={styles.payment_method_item}\n                                loading={this.state.processing_alipay}\n                                onClick={()=>this.selectPaymentMethod('alipay')}>Alipay</Button>\n                        <br/>\n                        <br/>\n                        <Button type=\"primary\" icon=\"credit-card\" className={styles.payment_method_item}\n                                loading={this.state.processing_credit}\n                                onClick={()=>this.selectPaymentMethod('credit')}>Credit Card</Button>\n                    </div>\n                </div>\n            </Modal>\n        );\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}