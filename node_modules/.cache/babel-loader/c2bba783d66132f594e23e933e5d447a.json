{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/website/src/views/BindingWallet.js\";\nimport React from 'react';\nimport styles from '../styles/binding-wallet.module.scss';\nimport { Alert, message, Icon, Spin } from 'antd';\nimport StorageUtils from \"../tools/StorageUtils\";\nimport WebServerRestClient from \"../tools/WebServerRestClient\";\nimport UserComponent from \"../components/UserComponent\";\nexport default class BindingCode extends UserComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      doing: false,\n      ethAddress: '',\n      showMessageDialog: false\n    };\n  }\n\n  componentDidMount() {}\n\n  handleInputChange(event) {\n    const target = event.target;\n    const value = target.type === 'checkbox' ? target.checked : target.value;\n    const name = target.name;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  handleInputFocus(event) {\n    const target = event.target;\n\n    if (target.type === 'text') {\n      this.setState({\n        showMessageDialog: false\n      });\n    }\n  }\n\n  saveWalletAddress() {\n    this.setState({\n      showMessageDialog: false\n    });\n    let ethAddress = this.state.ethAddress.trim();\n\n    if (ethAddress == '') {\n      this.setState({\n        showMessageDialog: true,\n        message: \"Please enter the email address\"\n      });\n      return false;\n    }\n\n    this.setState({\n      doing: true\n    });\n    new WebServerRestClient().POST('/user/binding-eth-wallet', {\n      ethAddress: ethAddress,\n      userId: window.CurrentUser.userId\n    }).then(response => {\n      console.log(\"binding-eth-address response -> \" + JSON.stringify(response));\n      this.setState({\n        doing: false\n      });\n\n      if (response.code == 200) {\n        let CurrentUser = StorageUtils.loadUser();\n        CurrentUser.ethAddress = ethAddress;\n        StorageUtils.saveUser(CurrentUser);\n        let from = this.getQueryString('from');\n\n        if (from) {\n          this.props.history.push(from);\n        } else {\n          this.props.history.push('/binding-code');\n        }\n      } else if (response.code == 401 || response.code == 403) {\n        message.warn(\"未登录！\");\n        this.props.history.push('/login');\n      } else {\n        this.setState({\n          showMessageDialog: true,\n          message: response['msg']\n        });\n      }\n    }).catch(err => {\n      this.setState({\n        doing: false\n      });\n      message.error(\"Error: \" + err.message);\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.form_center,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: styles.step_image,\n      src: require('../images/step-binding-wallet.png'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.step_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, \"\\u7ED1\\u5B9A\\u60A8\\u7684ETH\\u94B1\\u5305\\u5730\\u5740\\uFF1A\"), React.createElement(\"div\", {\n      className: styles.step_desc,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"1. \\u8BF7\\u4E0D\\u8981\\u586B\\u5199\\u4EA4\\u6613\\u6240ETH\\u5730\\u5740\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), \"2. \\u8BF7\\u786E\\u4FDD\\u5730\\u5740\\u6B63\\u786E\\uFF0C\\u60A8\\u7684\\u6536\\u76CA\\u4F1A\\u652F\\u4ED8\\u5230\\u8FD9\\u91CC\"), React.createElement(\"input\", {\n      type: 'text',\n      name: 'ethAddress',\n      className: styles.form_input,\n      placeholder: 'ETH 钱包地址',\n      onFocus: this.handleInputFocus.bind(this),\n      onChange: this.handleInputChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), this.state.showMessageDialog ? React.createElement(\"div\", {\n      className: styles.message_box,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(Alert, {\n      message: this.state.message,\n      type: \"warning\",\n      closable: true,\n      onClose: () => {\n        this.setState({\n          showMessageDialog: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    })) : null, React.createElement(\"div\", {\n      className: styles.form_button_row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: styles.form_button,\n      onClick: this.saveWalletAddress.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, this.state.doing ? React.createElement(Spin, {\n      indicator: React.createElement(Icon, {\n        type: \"loading\",\n        className: \"icon_loading\",\n        spin: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }) : '下一步'))));\n  }\n\n}","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/website/src/views/BindingWallet.js"],"names":["React","styles","Alert","message","Icon","Spin","StorageUtils","WebServerRestClient","UserComponent","BindingCode","constructor","props","state","doing","ethAddress","showMessageDialog","componentDidMount","handleInputChange","event","target","value","type","checked","name","setState","handleInputFocus","saveWalletAddress","trim","POST","userId","window","CurrentUser","then","response","console","log","JSON","stringify","code","loadUser","saveUser","from","getQueryString","history","push","warn","catch","err","error","render","container","form_center","step_image","require","step_title","step_desc","form_input","bind","message_box","form_button_row","form_button"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styles from '../styles/binding-wallet.module.scss';\nimport {Alert, message, Icon, Spin} from 'antd';\nimport StorageUtils from \"../tools/StorageUtils\";\nimport WebServerRestClient from \"../tools/WebServerRestClient\";\nimport UserComponent from \"../components/UserComponent\";\n\nexport default class BindingCode extends UserComponent {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            doing: false,\n            ethAddress: '',\n            showMessageDialog: false\n        }\n    }\n\n    componentDidMount() {\n\n    }\n\n    handleInputChange(event) {\n        const target = event.target;\n        const value = target.type === 'checkbox' ? target.checked : target.value;\n        const name = target.name;\n        this.setState({[name]: value});\n    }\n\n    handleInputFocus(event) {\n        const target = event.target;\n        if (target.type === 'text') {\n            this.setState({showMessageDialog: false});\n        }\n    }\n\n    saveWalletAddress() {\n        this.setState({showMessageDialog: false});\n        let ethAddress = this.state.ethAddress.trim();\n        if (ethAddress == '') {\n            this.setState({showMessageDialog: true, message: \"Please enter the email address\"});\n            return false;\n        }\n        this.setState({doing: true});\n        new WebServerRestClient().POST('/user/binding-eth-wallet', {\n            ethAddress: ethAddress,\n            userId: window.CurrentUser.userId\n        }).then(response => {\n            console.log(\"binding-eth-address response -> \" + JSON.stringify(response));\n            this.setState({doing: false});\n            if (response.code == 200) {\n                let CurrentUser = StorageUtils.loadUser();\n                CurrentUser.ethAddress = ethAddress;\n                StorageUtils.saveUser(CurrentUser);\n                let from = this.getQueryString('from');\n                if (from) {\n                    this.props.history.push(from);\n                } else {\n                    this.props.history.push('/binding-code');\n                }\n            } else if (response.code == 401 || response.code == 403) {\n                message.warn(\"未登录！\");\n                this.props.history.push('/login');\n            } else {\n                this.setState({showMessageDialog: true, message: response['msg']});\n            }\n        }).catch(err => {\n            this.setState({doing: false});\n            message.error(\"Error: \" + err.message);\n        });\n    }\n\n    render() {\n        return (\n            <div className={styles.container}>\n                <div className={styles.form_center}>\n                    <img className={styles.step_image} src={require('../images/step-binding-wallet.png')}/>\n                    <div className={styles.step_title}>绑定您的ETH钱包地址：</div>\n                    <div className={styles.step_desc}>\n                        1. 请不要填写交易所ETH地址<br/>\n                        2. 请确保地址正确，您的收益会支付到这里\n                    </div>\n                    <input type={'text'} name={'ethAddress'} className={styles.form_input}\n                           placeholder={'ETH 钱包地址'}\n                           onFocus={this.handleInputFocus.bind(this)}\n                           onChange={this.handleInputChange.bind(this)}/>\n                    {this.state.showMessageDialog ?\n                        <div className={styles.message_box}>\n                            <Alert message={this.state.message} type=\"warning\" closable={true}\n                                   onClose={() => {\n                                       this.setState({showMessageDialog: false})\n                                   }}/>\n                        </div>\n                        :\n                        null\n                    }\n                    <div className={styles.form_button_row}>\n                        <button className={styles.form_button} onClick={this.saveWalletAddress.bind(this)}>\n                            {this.state.doing ?\n                                <Spin indicator={<Icon type=\"loading\" className='icon_loading' spin/>}/>\n                                :\n                                '下一步'\n                            }\n                        </button>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}"]},"metadata":{},"sourceType":"module"}