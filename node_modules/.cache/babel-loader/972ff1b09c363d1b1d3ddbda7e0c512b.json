{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js\";\nimport React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport { Button, message, Modal, Icon } from 'antd';\nimport { RiPaypalLine } from 'react-icons/ri';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\nexport default class PaymentModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      processing: false\n    };\n  }\n\n  selectPaymentMethod(method) {\n    if (!StorageUtils.hasToken()) {\n      // need to login\n      this.props.loginCallback('payment');\n      return;\n    }\n\n    if (method == 'credit') {\n      this.setState({\n        processing_credit: true\n      });\n      new WebServerRestClient().GET('/user/token-validation').then(response => {\n        this.setState({\n          processing_credit: false\n        });\n\n        if (response.code == 200) {\n          this.props.selectionCallback(method);\n        } else if (response.code == 401 || response.code == 403) {\n          this.props.loginCallback('payment');\n          message.warn(\"请登录！\");\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        message.error(err.message);\n        this.setState({\n          processing_credit: false\n        });\n      });\n    } else if (method == 'alipay') {\n      this.setState({\n        processing_alipay: true\n      });\n      new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n        purchasePlanId: this.props.productDetail.id,\n        paymentWay: 6,\n        userId: StorageUtils.getUserId()\n      }).then(response => {\n        CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n        this.setState({\n          processing_alipay: false\n        });\n\n        if (response.code == 200) {\n          // close this modal\n          this.props.selectionCallback(method); // go to Alipay page\n\n          window.open(response.data, '_self');\n        } else if (response.code == 401 || response.code == 403) {\n          // need to login\n          this.props.loginCallback('payment');\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        this.setState({\n          processing_alipay: false\n        });\n        message.error(err.message);\n      });\n    } else if (method == 'paypal') {\n      this.setState({\n        processing_paypal: true\n      });\n      new WebServerRestClient().POST('/user/payment/create-paypal-order', {\n        purchasePlanId: this.props.productDetail.id,\n        paymentWay: 7,\n        userId: StorageUtils.getUserId()\n      }).then(response => {\n        CommonUtils.log(\"create-paypal-order response: \" + JSON.stringify(response));\n        this.setState({\n          processing_paypal: false\n        });\n\n        if (response.code == 200) {\n          // close this modal\n          this.props.selectionCallback(method); // go to PayPal page\n\n          window.open(response.data, '_self');\n        } else if (response.code == 401 || response.code == 403) {\n          // need to login\n          this.props.loginCallback('payment');\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        this.setState({\n          processing_paypal: false\n        });\n        message.error(err.message);\n      });\n    }\n  }\n\n  render() {\n    let isChinese = StorageUtils.getLanguage() === window.constants.LANGUAGE_CN;\n    return React.createElement(Modal, {\n      closable: false,\n      keyboard: true,\n      maskClosable: true,\n      destroyOnClose: true,\n      footer: null,\n      visible: this.props.visible,\n      onCancel: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal_close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"close-circle\",\n      onClick: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, isChinese ? React.createElement(\"div\", {\n      className: styles.product_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"SquirrelVPN \", this.props.productDetail.monthTextCN) : React.createElement(\"div\", {\n      className: styles.product_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, \"SquirrelVPN \", this.props.productDetail.monthText), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), isChinese ? React.createElement(\"div\", {\n      className: styles.product_details,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), window.language.payment_modal.detail1, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), window.language.payment_modal.detail2, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }), window.language.payment_modal.detail3) : React.createElement(\"div\", {\n      className: styles.product_details_en,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), window.language.payment_modal.detail1, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), window.language.payment_modal.detail2, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(Icon, {\n      type: \"check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }), window.language.payment_modal.detail3), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.product_price_box,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_price_box_filled,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, \" \"), React.createElement(\"div\", {\n      className: styles.product_price_text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"$\", this.props.productDetail.price, \" x \", this.props.productDetail.month, React.createElement(\"span\", {\n      className: styles.text_total,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, window.language.payment_modal.total, \" $\", this.props.productDetail.amount, \" \"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.select_method,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, window.language.payment_modal.select), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), StorageUtils.hasToken() ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      icon: \"alipay\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      loading: this.state.processing_alipay,\n      onClick: () => this.selectPaymentMethod('alipay'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, window.language.payment_modal.alipay), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      icon: \"credit-card\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      loading: this.state.processing_credit,\n      onClick: () => this.selectPaymentMethod('credit'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, \" \", window.language.payment_modal.credit), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      loading: this.state.processing_paypal,\n      onClick: () => this.selectPaymentMethod('paypal'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(RiPaypalLine, {\n      style: {\n        marginRight: 5\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), window.language.payment_modal.paypal)) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      icon: \"login\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      onClick: () => this.props.loginCallback('payment'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, window.language.login_text), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    })))));\n  }\n\n}\nPaymentModal.propTypes = {\n  visible: PropTypes.bool,\n  productDetail: PropTypes.object,\n  loginCallback: PropTypes.func,\n  selectionCallback: PropTypes.func,\n  onRequestClose: PropTypes.func\n};","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js"],"names":["React","PropTypes","styles","Button","message","Modal","Icon","RiPaypalLine","WebServerRestClient","StorageUtils","CommonUtils","PaymentModal","Component","constructor","props","state","processing","selectPaymentMethod","method","hasToken","loginCallback","setState","processing_credit","GET","then","response","code","selectionCallback","warn","catch","err","error","processing_alipay","POST","purchasePlanId","productDetail","id","paymentWay","userId","getUserId","log","JSON","stringify","window","open","data","processing_paypal","render","isChinese","getLanguage","constants","LANGUAGE_CN","visible","onRequestClose","container","product_title","monthTextCN","monthText","product_details","language","payment_modal","detail1","detail2","detail3","product_details_en","product_price","product_price_box","product_price_box_filled","product_price_text","price","month","text_total","total","amount","select_method","select","fontSize","payment_method_item","alipay","credit","marginRight","paypal","login_text","propTypes","bool","object","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport {Button, message, Modal, Icon} from 'antd';\nimport { RiPaypalLine } from 'react-icons/ri';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\n\nexport default class PaymentModal extends React.Component {\n\n    static propTypes = {\n        visible: PropTypes.bool,\n        productDetail: PropTypes.object,\n        loginCallback: PropTypes.func,\n        selectionCallback: PropTypes.func,\n        onRequestClose: PropTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            processing: false\n        }\n    }\n\n    selectPaymentMethod(method) {\n        if (!StorageUtils.hasToken()) {\n            // need to login\n            this.props.loginCallback('payment');\n            return;\n        }\n\n        if (method == 'credit'){\n            this.setState({processing_credit: true});\n            new WebServerRestClient().GET('/user/token-validation')\n                .then(response => {\n                    this.setState({processing_credit: false});\n                    if (response.code == 200) {\n                        this.props.selectionCallback(method);\n                    } else if (response.code == 401 || response.code == 403) {\n                        this.props.loginCallback('payment');\n                        message.warn(\"请登录！\")\n                    } else {\n                        message.warn(response['msg']);\n                    }\n                }).catch(err => {\n                message.error(err.message);\n                this.setState({processing_credit: false});\n            });\n        } else if (method == 'alipay') {\n            this.setState({processing_alipay: true});\n            new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n                purchasePlanId: this.props.productDetail.id,\n                paymentWay: 6,\n                userId: StorageUtils.getUserId()\n            }).then(response => {\n                CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n                this.setState({processing_alipay: false});\n                if (response.code == 200) {\n                    // close this modal\n                    this.props.selectionCallback(method);\n\n                    // go to Alipay page\n                    window.open(response.data, '_self');\n                } else if (response.code == 401 || response.code == 403) {\n                    // need to login\n                    this.props.loginCallback('payment');\n                } else {\n                    message.warn(response['msg']);\n                }\n            }).catch(err => {\n                this.setState({processing_alipay: false});\n                message.error(err.message);\n            });\n        } else if (method == 'paypal') {\n            this.setState({processing_paypal: true});\n            new WebServerRestClient().POST('/user/payment/create-paypal-order', {\n                purchasePlanId: this.props.productDetail.id,\n                paymentWay: 7,\n                userId: StorageUtils.getUserId()\n            }).then(response => {\n                CommonUtils.log(\"create-paypal-order response: \" + JSON.stringify(response));\n                this.setState({processing_paypal: false});\n                if (response.code == 200) {\n                    // close this modal\n                    this.props.selectionCallback(method);\n\n                    // go to PayPal page\n                    window.open(response.data, '_self');\n                } else if (response.code == 401 || response.code == 403) {\n                    // need to login\n                    this.props.loginCallback('payment');\n                } else {\n                    message.warn(response['msg']);\n                }\n            }).catch(err => {\n                this.setState({processing_paypal: false});\n                message.error(err.message);\n            });\n        }\n    }\n\n\n    render() {\n        let isChinese = StorageUtils.getLanguage() === window.constants.LANGUAGE_CN;\n        return (\n            <Modal\n                closable={false}\n                keyboard={true}\n                maskClosable={true}\n                destroyOnClose={true}\n                footer={null}\n                visible={this.props.visible }\n                onCancel={() => this.props.onRequestClose()}>\n                <div className=\"modal_close\">\n                    <Icon type=\"close-circle\" onClick={() => this.props.onRequestClose()}/>\n                </div>\n                <div className={styles.container}>\n                    {isChinese ? (\n                      <div  className={styles.product_title}\n                      >SquirrelVPN {this.props.productDetail.monthTextCN}</div>\n                    ) : (\n                      <div  className={styles.product_title}\n                      >SquirrelVPN {this.props.productDetail.monthText}</div>\n                    )}\n\n                    <br/>\n\n                    {isChinese ? (\n                         <div  className={styles.product_details}>\n                              <Icon type=\"check\" />{window.language.payment_modal.detail1}<br/>\n                              <Icon type=\"check\" />{window.language.payment_modal.detail2}<br/>\n                              <Icon type=\"check\" />{window.language.payment_modal.detail3}\n                         </div>\n                    ) : (\n                        <div  className={styles.product_details_en}>\n                             <Icon type=\"check\" />{window.language.payment_modal.detail1}<br/>\n                             <Icon type=\"check\" />{window.language.payment_modal.detail2}<br/>\n                             <Icon type=\"check\" />{window.language.payment_modal.detail3}\n                        </div>\n                    )}\n\n                    <br/>\n                    <div  className={styles.product_price}>\n                        <div className={styles.product_price_box}>\n                        </div>\n                        <div className={styles.product_price_box_filled}> </div>\n\n                        <div className={styles.product_price_text}>\n                           ${this.props.productDetail.price} x {this.props.productDetail.month}\n                           <span className={styles.text_total}>{window.language.payment_modal.total} ${this.props.productDetail.amount} </span>\n                        </div>\n                    </div>\n                    <div>\n                        <br/>\n                    <div className={styles.select_method}>{window.language.payment_modal.select}</div>\n                    <br/>\n                    {StorageUtils.hasToken() ?\n                        <div>\n                            <Button type=\"primary\" icon=\"alipay\" style={{fontSize: \"16px\"}}\n                                    className={styles.payment_method_item}\n                                    loading={this.state.processing_alipay}\n                                    onClick={() => this.selectPaymentMethod('alipay')}>{window.language.payment_modal.alipay}</Button>\n                            <br/>\n                            <br/>\n                            <Button type=\"primary\" icon=\"credit-card\" style={{fontSize: \"16px\"}}\n                                    className={styles.payment_method_item}\n                                    loading={this.state.processing_credit}\n                                    onClick={() => this.selectPaymentMethod('credit')}> {window.language.payment_modal.credit}</Button>\n                            <br/>\n                            <br/>\n                            <Button type=\"primary\" style={{fontSize: \"16px\"}}\n                                    className={styles.payment_method_item}\n                                    loading={this.state.processing_paypal}\n                                    onClick={() => this.selectPaymentMethod('paypal')}>\n                                <RiPaypalLine style={{marginRight: 5}}/>\n                                {window.language.payment_modal.paypal}\n                            </Button>\n                        </div>\n                        :\n                        <div>\n                            <Button type=\"primary\" icon=\"login\" style={{fontSize: \"16px\"}}\n                                    className={styles.payment_method_item}\n                                    onClick={() => this.props.loginCallback('payment')}>{window.language.login_text}</Button>\n                            <br/>\n                        </div>\n                    }\n                    </div>\n                </div>\n            </Modal>\n        );\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}