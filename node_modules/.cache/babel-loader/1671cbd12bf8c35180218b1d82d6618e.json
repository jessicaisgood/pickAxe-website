{"ast":null,"code":"var _jsxFileName = \"/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js\";\nimport React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport { Button, message, Modal, Icon } from 'antd';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\nexport default class PaymentModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      processing: false\n    };\n  }\n\n  selectPaymentMethod(method) {\n    if (!StorageUtils.hasToken()) {\n      // need to login\n      this.props.loginCallback('payment');\n      return;\n    }\n\n    if (method == 'credit') {\n      this.setState({\n        processing_credit: true\n      });\n      new WebServerRestClient().GET('/user/token-validation').then(response => {\n        this.setState({\n          processing_credit: false\n        });\n\n        if (response.code == 200) {\n          this.props.selectionCallback(method);\n        } else if (response.code == 401 || response.code == 403) {\n          this.props.loginCallback('payment');\n          message.warn(\"请登录！\");\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        message.error(err.message);\n        this.setState({\n          processing_credit: false\n        });\n      });\n    } else if (method == 'alipay') {\n      this.setState({\n        processing_alipay: true\n      });\n      new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n        purchasePlanId: this.props.productDetail.id,\n        paymentWay: 6,\n        userId: StorageUtils.getUserId()\n      }).then(response => {\n        CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n        this.setState({\n          processing_alipay: false\n        });\n\n        if (response.code == 200) {\n          // close this modal\n          this.props.selectionCallback(method); // go to Alipay page\n\n          let a = document.createElement('a');\n          a.target = '_blank';\n          a.href = response.data;\n          a.click();\n        } else if (response.code == 401 || response.code == 403) {\n          // need to login\n          this.props.loginCallback('payment');\n        } else {\n          message.warn(response['msg']);\n        }\n      }).catch(err => {\n        this.setState({\n          processing_alipay: false\n        });\n        message.error(err.message);\n      });\n    }\n  }\n\n  render() {\n    return React.createElement(Modal, {\n      closable: false,\n      keyboard: true,\n      maskClosable: true,\n      destroyOnClose: true,\n      footer: null,\n      visible: this.props.visible,\n      onCancel: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal_close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"close-circle\",\n      onClick: () => this.props.onRequestClose(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: styles.container,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.product_title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"SquirrelVPN \", this.props.productDetail.monthText), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_details,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, \"Unlimited data & Support 3 devices\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_price,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: styles.product_price_box,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_price_box_filled,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \" \"), React.createElement(\"div\", {\n      className: styles.product_price_text,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, \"$\", this.props.productDetail.price, \" x \", this.props.productDetail.month, React.createElement(\"span\", {\n      className: styles.text_total,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"Total: $\", this.props.productDetail.amount, \" \"))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: styles.product_details,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, window.language.payment_modal.select), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      icon: \"alipay\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      loading: this.state.processing_alipay,\n      onClick: () => this.selectPaymentMethod('alipay'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"Alipay\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }), React.createElement(Button, {\n      type: \"primary\",\n      icon: \"credit-card\",\n      style: {\n        fontSize: \"16px\"\n      },\n      className: styles.payment_method_item,\n      loading: this.state.processing_credit,\n      onClick: () => this.selectPaymentMethod('credit'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"Credit Card\"))));\n  }\n\n}\nPaymentModal.propTypes = {\n  visible: PropTypes.bool,\n  productDetail: PropTypes.object,\n  loginCallback: PropTypes.func,\n  selectionCallback: PropTypes.func,\n  onRequestClose: PropTypes.func\n};","map":{"version":3,"sources":["/Users/wangxi05104/Desktop/website/src/views/modal/PaymentModal.js"],"names":["React","PropTypes","styles","Button","message","Modal","Icon","WebServerRestClient","StorageUtils","CommonUtils","PaymentModal","Component","constructor","props","state","processing","selectPaymentMethod","method","hasToken","loginCallback","setState","processing_credit","GET","then","response","code","selectionCallback","warn","catch","err","error","processing_alipay","POST","purchasePlanId","productDetail","id","paymentWay","userId","getUserId","log","JSON","stringify","a","document","createElement","target","href","data","click","render","visible","onRequestClose","container","product_title","monthText","product_details","product_price","product_price_box","product_price_box_filled","product_price_text","price","month","text_total","amount","window","language","payment_modal","select","fontSize","payment_method_item","propTypes","bool","object","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from \"prop-types\";\nimport styles from '../../styles/modal/payment-modal.module.scss';\nimport 'antd/dist/antd.css';\nimport {Button, message, Modal, Icon} from 'antd';\nimport WebServerRestClient from \"../../tools/WebServerRestClient\";\nimport StorageUtils from \"../../tools/StorageUtils\";\nimport CommonUtils from \"../../tools/CommonUtils\";\n\nexport default class PaymentModal extends React.Component {\n\n    static propTypes = {\n        visible: PropTypes.bool,\n        productDetail: PropTypes.object,\n        loginCallback: PropTypes.func,\n        selectionCallback: PropTypes.func,\n        onRequestClose: PropTypes.func\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            processing: false\n        }\n    }\n\n    selectPaymentMethod(method) {\n        if (!StorageUtils.hasToken()) {\n            // need to login\n            this.props.loginCallback('payment');\n            return;\n        }\n\n        if (method == 'credit'){\n            this.setState({processing_credit: true});\n            new WebServerRestClient().GET('/user/token-validation')\n                .then(response => {\n                    this.setState({processing_credit: false});\n                    if (response.code == 200) {\n                        this.props.selectionCallback(method);\n                    } else if (response.code == 401 || response.code == 403) {\n                        this.props.loginCallback('payment');\n                        message.warn(\"请登录！\")\n                    } else {\n                        message.warn(response['msg']);\n                    }\n                }).catch(err => {\n                message.error(err.message);\n                this.setState({processing_credit: false});\n            });\n        } else if (method == 'alipay') {\n            this.setState({processing_alipay: true});\n            new WebServerRestClient().POST('/user/payment/create-alipay-order', {\n                purchasePlanId: this.props.productDetail.id,\n                paymentWay: 6,\n                userId: StorageUtils.getUserId()\n            }).then(response => {\n                CommonUtils.log(\"create-alipay-order response: \" + JSON.stringify(response));\n                this.setState({processing_alipay: false});\n                if (response.code == 200) {\n                    // close this modal\n                    this.props.selectionCallback(method);\n\n                    // go to Alipay page\n                    let a = document.createElement('a');\n                    a.target = '_blank';\n                    a.href = response.data;\n                    a.click();\n                } else if (response.code == 401 || response.code == 403) {\n                    // need to login\n                    this.props.loginCallback('payment');\n                } else {\n                    message.warn(response['msg']);\n                }\n            }).catch(err => {\n                this.setState({processing_alipay: false});\n                message.error(err.message);\n            });\n        }\n    }\n\n\n    render() {\n        return (\n            <Modal\n                closable={false}\n                keyboard={true}\n                maskClosable={true}\n                destroyOnClose={true}\n                footer={null}\n                visible={this.props.visible }\n                onCancel={() => this.props.onRequestClose()}>\n                <div className=\"modal_close\">\n                    <Icon type=\"close-circle\" onClick={() => this.props.onRequestClose()}/>\n                </div>\n                <div className={styles.container}>\n                    <div  className={styles.product_title}\n                      >SquirrelVPN {this.props.productDetail.monthText}</div>\n                    <br/>\n                    <div  className={styles.product_details}\n                      >Unlimited data & Support 3 devices</div>\n                    <br/>\n                    <div  className={styles.product_price}>\n                        <div className={styles.product_price_box}>\n                        </div>\n                        <div className={styles.product_price_box_filled}> </div>\n\n                        <div className={styles.product_price_text}>\n                           ${this.props.productDetail.price} x {this.props.productDetail.month}\n                           <span className={styles.text_total}>Total: ${this.props.productDetail.amount} </span>\n                        </div>\n                    </div>\n                    <div>\n                        <br/>\n                    <div className={styles.product_details}>{window.language.payment_modal.select}</div>\n                    <br/>\n                    <Button type=\"primary\" icon=\"alipay\" style={{fontSize: \"16px\"}} className={styles.payment_method_item}\n                            loading={this.state.processing_alipay}\n                            onClick={()=>this.selectPaymentMethod('alipay')}>Alipay</Button>\n                    <br/>\n                    <br/>\n                    <Button type=\"primary\" icon=\"credit-card\"  style={{fontSize: \"16px\"}} className={styles.payment_method_item}\n                            loading={this.state.processing_credit}\n                            onClick={()=>this.selectPaymentMethod('credit')}>Credit Card</Button>\n                    </div>\n                </div>\n            </Modal>\n        );\n    }\n\n}\n"]},"metadata":{},"sourceType":"module"}